<div class="rogue-trader dialog">
    <div class="flex row wrap background border" style="flex-basis: 100%;margin-bottom: 5px">
        <h1>{{localize "DIALOG.ADD_SKILL_MODIFIER"}}</h1>
        
        <div class="flex row wrapper">
            <label style="width: 50%;">{{localize "DIALOG.SKILL_NAME"}}</label>
            <select id="attribute-name" data-dtype="String" style="width: 50%;">
                {{#if hasSkills}}
                    {{#if hasBasicSkills}}
                    <optgroup label="{{localize 'DIALOG.BASIC_SKILLS'}}">
                        {{#each skillOptions}}
                            {{#if (eq type 'skill')}}
                                <option value="{{value}}" id="modifier-option-{{value}}" 
                                        data-dtype="String" data-option-label="{{localize label}}">
                                    {{localize label}}
                                </option>
                            {{/if}}
                        {{/each}}
                    </optgroup>
                    {{/if}}
                    
                    {{#if hasSpecialities}}
                        <optgroup label="{{localize 'DIALOG.SPECIALITIES'}}">
                            {{#each skillOptions}}
                                {{#if (eq type 'speciality')}}
                                    {{#if isCustom}}
                                        <!-- Для кастомных специализаций -->
                                        <option value="{{value}}" id="modifier-option-{{value}}" 
                                                data-dtype="String" data-option-label="{{parentName}}: {{label}}"
                                                style="font-style: italic;">
                                            * {{parentName}}: {{label}}
                                        </option>
                                    {{else}}
                                        <!-- Для встроенных специализаций -->
                                        <option value="{{value}}" id="modifier-option-{{value}}" 
                                                data-dtype="String" data-option-label="{{parentName}}: {{localize label}}">
                                            {{parentName}}: {{localize label}}
                                        </option>
                                    {{/if}}
                                {{/if}}
                            {{/each}}
                        </optgroup>
                    {{/if}}
                {{else}}
                    <option value="">{{localize "DIALOG.NO_SKILLS_AVAILABLE"}}</option>
                {{/if}}
            </select>
        </div>
        
        <div class="flex row wrapper">
            <label style="width: 50%;">{{localize "DIALOG.SKILL_VALUE"}}</label>
            <input id="modifier-skill-value" type="number" value="0" data-dtype="Number" 
                   placeholder="{{localize 'DIALOG.MODIFIER_PLACEHOLDER'}}" style="width: 50%;"/>
        </div>
    </div>
</div>

<script>
    $(".wrapper input").focusin(function () {
        $(this).select();
    });
    
    // ДОБАВЛЕНО: Подсветка выбранной опции для кастомных специализаций
    $(document).ready(function() {
        $('#attribute-name').change(function() {
            const selectedOption = $(this).find('option:selected');
            if (selectedOption.css('font-style') === 'italic') {
                selectedOption.css('background-color', '#f0f0f0');
            } else {
                selectedOption.css('background-color', '');
            }
        });
        
        // Инициализация при загрузке
        $('#attribute-name').trigger('change');
    });
</script>